import{r,j as t,C as M,O as Q,A as Y,P as H,h as N,b as W,a as Z}from"./vendor-9229993e.js";import{f as D}from"./three-vendor-bf31962e.js";import{f as _,g as J}from"./index-cd57e659.js";import"./motion-vendor-fcaeed3e.js";const K=({isMobile:n,visible:x=!0,isInteractingRef:E=null})=>{const j=N("./desktop_pc/scene.gltf"),e=r.useRef(),p=r.useRef(0),d=r.useRef({x:0}),R=s=>{var o,l;if(!n)return;let i=s.movementX??((o=s.nativeEvent)==null?void 0:o.movementX);if(i===void 0){const h=s.clientX??((l=s.nativeEvent)==null?void 0:l.clientX)??d.current.x;i=h-d.current.x,d.current.x=h}const v=.004;p.current+=-i*v;try{s.stopPropagation()}catch{}},b=s=>{var i;if(n){d.current.x=s.clientX??((i=s.nativeEvent)==null?void 0:i.clientX)??d.current.x;try{s.stopPropagation()}catch{}}},w=s=>{if(n)try{s.stopPropagation()}catch{}};return r.useEffect(()=>{try{if(!e.current)return;n?(e.current.position.set(-.1,-3,-1.5),e.current.rotation.set(0,-.8,0),e.current.scale.set(.375,.375,.375)):(e.current.position.set(1,-3,-1.5),e.current.rotation.set(.02,-.8,0),e.current.scale.set(.6,.6,.6))}catch{}},[n,j]),W(({clock:s})=>{if(!e.current)return;const i=s.getElapsedTime(),v=.08*Math.sin(i*.6),o=.08,l=x?n?1.5:2.4:.2;e.current.scale.x+=(l-e.current.scale.x)*o,e.current.scale.y+=(l-e.current.scale.y)*o,e.current.scale.z+=(l-e.current.scale.z)*o;const h=x?-2:4;E&&E.current||(e.current.position.y+=(h-e.current.position.y)*o);const L=.02,P=x?-.2+v:-1;e.current.rotation.x+=(L-e.current.rotation.x)*o,e.current.rotation.y+=(P-e.current.rotation.y)*o,e.current.rotation.z+=(0-e.current.rotation.z)*o;try{n&&(e.current.rotation.y+=p.current,p.current*=.92,Math.abs(p.current)<1e-5&&(p.current=0))}catch{}}),t.jsxs("mesh",{children:[t.jsx("hemisphereLight",{intensity:.15,groundColor:"black"}),t.jsx("pointLight",{intensity:.1}),t.jsx("spotLight",{position:[-10,50,10],angle:.12,penumbra:1,intensity:.1,castShadow:!0,"shadow-mapSize":512}),t.jsxs("group",{ref:e,scale:[n?.375:.6,n?.375:.6,n?.375:.6],position:n?[-.1,-3,-1.5]:[1,-3,-1.5],rotation:[n?0:.02,-.8,0],children:[n&&t.jsxs("mesh",{position:[0,0,0],frustumCulled:!1,onPointerOver:b,onPointerOut:w,onPointerMove:R,children:[t.jsx("planeGeometry",{args:[20,20]}),t.jsx("meshBasicMaterial",{transparent:!0,opacity:0,depthWrite:!1,side:2})]}),t.jsx("primitive",{object:j.scene})]})]})},te=({active:n=!0,sectionIndex:x=0})=>{const{suspendAboveOf:E,exclusiveSection:j}=_(),e=r.useRef(null),p=r.useRef(null),d=r.useRef(),R=r.useRef(!1),b=({controlsRef:m,isInteractingRef:c})=>{const{camera:a}=Z(),f=r.useRef(null);return r.useRef(null),r.useEffect(()=>{let u=m.current;if(!u)return;const g=a.position.clone(),F=u.target.clone(),G=C=>1+1.6*Math.pow(C-1,3)+.6*Math.pow(C-1,2);let A=!1,O=0,q=600,z=new D,X=new D;const B=C=>{if(!A)return;const T=Math.min(1,(C-O)/q),S=G(T);if(a.position.lerpVectors(z,g,S),u.target.lerpVectors(X,F,S),u.update(),T>=1){A=!1;return}f.current=requestAnimationFrame(B)},V=()=>{c&&(c.current=!0),A=!1,f.current&&cancelAnimationFrame(f.current)},k=()=>{c&&(c.current=!1),z.copy(a.position),X.copy(u.target),A=!0,O=performance.now(),f.current&&cancelAnimationFrame(f.current),f.current=requestAnimationFrame(B)};return u.addEventListener("start",V),u.addEventListener("end",k),()=>{u.removeEventListener("start",V),u.removeEventListener("end",k),f.current&&cancelAnimationFrame(f.current)}},[m,c]),null};r.useEffect(()=>()=>{if(p.current)try{p.current()}catch{}},[]);const[w,s]=r.useState(!1);r.useEffect(()=>{const m=window.matchMedia("(max-width: 820px)");s(m.matches);const c=a=>{s(a.matches)};return m.addEventListener("change",c),()=>{m.removeEventListener("change",c)}},[]);const i=j!==null&&x!==j,v=E!==null&&x<E,o=i||v,[l,h]=r.useState(!o&&n),[L,P]=r.useState(!o&&n),y=r.useRef();return r.useEffect(()=>{if(o||!n){l&&(P(!1),clearTimeout(y.current),y.current=setTimeout(()=>h(!1),600));return}return l?P(!0):(h(!0),clearTimeout(y.current),y.current=setTimeout(()=>P(!0),50)),()=>clearTimeout(y.current)},[o,n,l]),l?t.jsxs(M,{style:{touchAction:"pan-y"},frameloop:L?"always":"demand",shadows:!0,dpr:[1,1.25],onCreated:m=>{try{const c=m.gl,a=c.domElement;e.current=a;const f=g=>{try{g.preventDefault()}catch{}},u=()=>{};try{a.style.touchAction="pan-y pinch-zoom",a.setAttribute("touch-action","pan-y pinch-zoom")}catch{}a.addEventListener("webglcontextlost",f,!1),a.addEventListener("webglcontextrestored",u,!1),p.current=()=>{try{a.removeEventListener("webglcontextlost",f),a.removeEventListener("webglcontextrestored",u)}catch{}try{c&&typeof c.dispose=="function"&&c.dispose()}catch{}}}catch{}},camera:w?{position:[-5,20,30],fov:16}:{position:[5,17,5],fov:26},gl:{preserveDrawingBuffer:!1,antialias:!1,powerPreference:"high-performance"},children:[t.jsxs(r.Suspense,{fallback:t.jsx(J,{}),children:[!w&&t.jsxs(t.Fragment,{children:[t.jsx(Q,{ref:d,enableZoom:!1,enableRotate:!0,enablePan:!0,maxPolarAngle:Math.PI/2,minPolarAngle:Math.PI/2}),t.jsx(b,{controlsRef:d,isInteractingRef:R})]}),t.jsx(K,{isMobile:w,visible:L,isInteractingRef:R})]}),t.jsx(Y,{pixelated:!0}),t.jsx(H,{all:!0})]}):t.jsx("div",{className:"w-full h-full bg-transparent"})};export{te as default};
